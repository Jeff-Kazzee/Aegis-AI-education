# Story 1.4: Substack Integration Page

## Status
Draft

## Story
**As a** user,
**I want** to see the latest Substack posts on the website,
**so that** I can access all the project's written content in one place.

## Acceptance Criteria
1. A new page is created at the /posts route
2. The page dynamically fetches and displays a list of the most recent posts from the Substack publication
3. Each item in the list shows the post's title, publication date, and a brief summary
4. Clicking on any post links the user directly to the full article on Substack

## Tasks / Subtasks
- [ ] Create API Route for Substack Integration (AC: 2)
  - [ ] Create `src/app/api/posts/route.ts` serverless function
  - [ ] Implement RSS feed fetching using rss-parser 3.13.x
  - [ ] Parse Substack RSS feed and return JSON response
  - [ ] Include server-side caching to minimize redundant calls
  - [ ] Handle error cases (500 response) when feed fetch fails
- [ ] Create Substack Service Library (AC: 2)
  - [ ] Create `src/lib/substack.ts` utility library
  - [ ] Implement SubstackPost type definitions
  - [ ] Create helper functions for API data transformation
  - [ ] Ensure TypeScript type safety throughout
- [ ] Create Posts Page Route (AC: 1, 2, 3, 4)
  - [ ] Create `src/app/(pages)/posts/page.tsx` following Next.js App Router
  - [ ] Implement data fetching from internal /api/posts endpoint
  - [ ] Display posts in clean, readable list format
  - [ ] Show title, publication date, and summary for each post
  - [ ] Implement external links to full Substack articles
- [ ] Implement UI Components (AC: 3, 4)
  - [ ] Create post list display with proper styling
  - [ ] Ensure external links open in new tabs with security attributes
  - [ ] Implement loading states while fetching data
  - [ ] Add error handling for failed API calls
  - [ ] Style components using Tailwind CSS for consistency

## Dev Notes

### Previous Story Insights
- Story 1.1: Next.js project with TypeScript and serverless functions capability established
- Story 1.2: Header/Footer layout with "Posts" navigation link routing to /posts
- Story 1.3: Pattern established for external links with proper security attributes

### API Specification Requirements
[Source: architecture/api-specification.md]
**Internal API Endpoint: GET /api/posts**
- **Purpose**: Retrieves latest posts from integrated Substack feed
- **Response Format**: JSON array of SubstackPost objects
- **Success Response**: 200 with array of posts
- **Error Response**: 500 for server/parsing failures
- **Caching**: Server-side cache to minimize Substack server calls

### Data Model Requirements
[Source: architecture/data-models.md]
**SubstackPost Data Model:**
```typescript
interface SubstackPost {
  title: string;      // The title of the post
  link: string;       // Direct URL to full post on Substack
  pubDate: string;    // Publication date
  summary: string;    // Short summary of the post
  author: string;     // Author of the post
}
```

### Technology Stack for Integration
[Source: architecture/tech-stack.md]
- **API Integration**: rss-parser 3.13.x - Simple library for fetching/parsing Substack RSS feed
- **Framework**: Next.js 14.2.x - Provides API routes for serverless functions
- **Language**: TypeScript 5.4.x - Type safety for API responses and data models
- **Styling**: Tailwind CSS 3.4.x - Consistent styling for post displays

### Project Structure for API & Pages
[Source: architecture/unified-project-structure.md]
Required file locations:
```
src/
├── app/
│   ├── (pages)/
│   │   └── posts/
│   │       └── page.tsx     <- Posts display page
│   ├── api/
│   │   └── posts/
│   │       └── route.ts     <- Serverless API function
└── lib/
    └── substack.ts          <- Utility library
```

### Functional Requirements
[Source: prd/requirements.md - FR2]
- **FR2**: Platform must display latest posts from integrated Substack publication
- Dynamic fetching and display of recent posts required
- Each post must show title, date, and summary
- Links must direct to full Substack articles

### UI/UX Design Requirements
[Source: prd/user-interface-design-goals.md]
- **Design Aesthetic**: Clean, professional list display
- **Content Focus**: Prioritize readability and clarity
- **Navigation**: Simple and predictable interaction patterns
- **Accessibility**: WCAG 2.1 AA compliant design
- **Responsive**: Work seamlessly on desktop and mobile

### External Integration Security
- External Substack links must include `rel="noopener noreferrer"`
- Use `target="_blank"` for new tab behavior
- Ensure HTTPS connections for all external requests
- Handle RSS feed parsing errors gracefully

### Caching Strategy
- Implement server-side caching to reduce load on Substack servers
- Cache responses for reasonable duration (suggested 15-30 minutes)
- Ensure cache invalidation works properly
- Handle cache failures gracefully

### Error Handling Requirements
- Graceful handling of RSS feed unavailability
- User-friendly error messages for display failures
- Fallback content when Substack is unreachable
- Proper HTTP status codes (500 for server errors)

### Testing Standards
[Source: architecture/testing-strategy-and-standards.md]
- **API Testing**: Test serverless function with Jest 29.7.x
- **Component Testing**: Use React Testing Library 15.0.x for page components
- **Integration Testing**: Test API-to-UI data flow
- **Test Location**: Place tests in `/tests/` directory

### Accessibility Requirements
- Use semantic HTML for post listings (article, h2, time elements)
- Ensure proper heading hierarchy
- Include ARIA labels for external links
- Maintain keyboard navigation for all interactive elements
- Test with screen readers for content clarity

## Change Log
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-07-25 | 1.0 | Initial story creation | Sarah, PO |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be populated here after implementation*